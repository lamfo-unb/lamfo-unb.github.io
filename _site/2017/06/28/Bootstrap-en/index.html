<!DOCTYPE html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Laboratório de Aprendizado de Máquina Aplicado a Finanças e Organizações">

    <title>Bootstrap - LAMFO</title>

    <link rel="canonical" href="http://localhost:4000/2017/06/28/Bootstrap-en/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="LAMFO">

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://lamfo.unb.br">LAMFO</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
		<li>
                    <a href="https://lamfo-unb.github.io/about/">Sobre</a>
                </li>
		
		<!-- https://lamfo-unb.github.io/contact/-->
		
		<!--    
		 
		
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
				
                <li>
                    <a href="/contact/">Contact</a>
                </li>
				
                
				
                <li>
                    <a href="/data/">Data</a>
                </li>
				
                
				
                <li>
                    <a href="/projects/">Projects</a>
                </li>
				
                
		-->

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/bootstrap/juskteez-vu-1041.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Bootstrap</h1>
                    
                    <span class="meta">Posted by Mariana Rosa Montenegro on June 28, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<link href="https://fonts.googleapis.com/css?family=Rock%20Salt" rel="stylesheet">

<link href="https://fonts.googleapis.com/css?family=Sofia" rel="stylesheet">

<h1 id="bootstrap">Bootstrap</h1>

<p>In this post, we present a statistic technique called Bootstrap. Nothing better than an example of brigadeiro (a typical and popular desert in Brazil) for a preliminary taste on the subject.</p>

<p><img src="/img/bootstrap/Avel%C3%A3.jpg" width="700"></p>

<p>Imagine you own a candy store. A customer expects that, when buying a brigadeiro, it will have, on average, the same weight as the one of another customer. However, it is impossible to weigh all the brigadeiros that will be produced in your store!!</p>

<p>What should we do then??</p>

<p>You, the owner of the establishment, can use sampling techniques to randomly select 150 brigadeiros and calculate the average weight of these brigadeiros. Done this, you can conclude that the population mean is within an margin error relative to the sample mean.</p>

<p>Suppose you want to know, after a few months, what the average weight of the brigadeiro would be on a given production line date, taking into account greater accuracy.</p>

<p>As several variables have emerged, we can no longer use the sample of brigadeiros produced today as a baseline. Among these variables involved, we consider different types of sugar, cocoa and butter, new flavors, type of confectionery, the filling, among others.</p>

<p>Let us assume that the only information we have is the weight of a sample of 150 brigadeiros on the initial testing date. We can consider the initial error margin as our most relevant information.</p>

<p>Fortunately, to solve this problem there is</p>

<h1>
<div style="font-family: 'Rock Salt';font-size: 60px;">
Bootstrap!! <img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20" align="absmiddle">
</div>
</h1>

<p>In this scenario, we create our Bootstrap sample, which arises from the random sampling of the 150 known weights. If weight replacement is allowed, this bootstrap sample will not necessarily be identical to the initial sample. Some data may be omitted and others may be repeated. In this scenarion, numerous bootstrap samples are quickly created.</p>

<h2 id="technical-view">Technical View</h2>

<p>Let’s now introduce Bootstrap with more detail.</p>

<p>This statistical technique was initially proposed by Bradley Efron in 1979. It has been gaining strength, especially due to the advances in computer power.</p>

<div style="font-family: 'Sofia';font-size: 30px;">What is the origin of the word Bootstrap??</div>

<p>Bootstrap term has English origin and refers to the lace on the back of a boot which helps to put it on.</p>

<p>Its use comes from the phrase “To lift himself up by his bootstraps”, that is, “Get up using your bootstrap”. Here, there is an allusion to something impossible, difficult to achieve.</p>

<p>Imagine getting up in the air pulling only pieces of leather from your boot. This is impossible! And the idea that this model wants to bring is to be able to do the impossible.</p>

<p>The story of Baron Munchausen, also mentioned in the origin of the Bootstrap concept, tells that he was able to raise himself and his horse from a swamp by pulling his own hair (specifically, his ponytail). However, in this history there is no use of the word bootstrap as we know it and no other explicit reference to bootstraps has been found elsewhere in the various versions of Munchausen tales.</p>

<div class="row">

<div class="col-md-6">
<img class="img-responsive thumbnail" src="/img/bootstrap/boot2.jpg" alt="mat_elis_1" style="width:0.000001">
<div class="caption">
</div>
</div>

<div class="col-md-6">
<img class="img-responsive thumbnail" src="/img/bootstrap/pic2.png" alt="mat_elis_2" style="width:0.000001">
<div class="caption">
</div>
</div>
</div>

<h3 id="theory">Theory</h3>

<p>Think about the case of a random sample of size <em>n</em> , from a probability distribution function <em>F</em> undefined:
<script type="math/tex">X_i=x_i,     X_i</script> <script type="math/tex">\sim</script> <script type="math/tex">F_{i}</script>, <script type="math/tex">i=1,2,...,n</script>.</p>

<p>Let <script type="math/tex">X= (X_1,X_2,...X_n)</script> and <script type="math/tex">x=(x_1,x_2,...,x_n)</script> be the random variables and the observations of the independent random variables, with the same distribution function * F <em>. We will investigate the variability and the sampling distribution of the local estimation calculation from the sample of size *n</em>. We denote this local estimate as <script type="math/tex">\widehatθ</script>. Note that <script type="math/tex">\widehatθ</script> is a function of the random variables <script type="math/tex">(X_1, X_2, ... X_n)</script> and, therefore, has a probability distribution, its sample distribution, which is determined by <em>n</em> and <em>F</em>.</p>

<p>Based on Efron and Tibshirani (1993), the basic steps for creating Bootstrap are:</p>

<h4 id="step-1">Step 1:</h4>
<p>Construct, from the sample, an empirical probability distribution <script type="math/tex">F_n</script>, inserting, in each point <script type="math/tex">x_1, x_2, ... x_n</script> of the sample, a probability <script type="math/tex">1/n</script>.</p>

<p>Characterized as an empirical distribution function of the sample, this is a non-parametric estimate of the maximum probability from the population distribution, <em>F</em>.</p>

<h4 id="step-2">Step 2:</h4>
<p>Perform the resample: draw a random sample of size <em>n</em> with replacement from the <script type="math/tex">F_n</script> distribution function.</p>

<h4 id="step-3">Step 3:</h4>
<p>Calculate for this resampling the statistic of interest <script type="math/tex">T_n</script>, generating <script type="math/tex">T_n^*</script>.</p>

<h4 id="step-4">Step 4:</h4>
<p>Repeat steps 2 and 3 <em>B</em> times. To create <em>B</em> resamples, <em>B</em> must be a large value. The size of <em>B</em> depends on tests that will be performed with the data. When an estimate with confidence interval of <script type="math/tex">T_n</script> is required, it is suggested that <em>B</em> should be at least equal to 1000.</p>

<h4 id="step-5">Step 5:</h4>
<p>Build, from the value <em>B</em> of <script type="math/tex">T_n</script>, the relative frequency of the histogram, assigning probability of <script type="math/tex">1/B</script> to each point <script type="math/tex">T_n^1</script>, <script type="math/tex">T_n^2</script>,…, <script type="math/tex">T_n^B</script>.</p>

<p>The obtained distribution is the Bootstrap estimate of the sampling distribution of <script type="math/tex">T_n</script>. One can make inferences from parameter θ, using this distribution, estimating <script type="math/tex">T_n</script>.</p>

<h2 id="bootstrap-and-stocks-in-financial-market-using-r">Bootstrap and stocks in financial market using R</h2>

<p>In the following example, we will create the Bootstrap sample for the daily returns of Apple shares and the S&amp;P500 index from 06/02/2016 to 05/31/2017. To do so, first download the base <em>bootstrap.txt</em> from the following <a href="https://raw.githubusercontent.com/lamfo-unb/lamfo-data/master/dadosBootstrap.txt">file</a>. Now, read the database in R using the code below:</p>

<div class="language-R highlighter-rouge">
<pre class="highlight"><code><span class="n">dados</span><span class="o">&lt;-</span><span class="n">read.table</span><span class="p">(</span><span class="n">file.choose</span><span class="p">())</span><span class="w">
</span></code></pre>
</div>
<p>To work with this file type the following command:</p>

<div class="language-R highlighter-rouge">
<pre class="highlight"><code><span class="n">spxret</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dados</span><span class="p">[,</span><span class="w"> </span><span class="s1">'SP500index'</span><span class="p">]</span><span class="w">
</span><span class="n">applret</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dados</span><span class="p">[,</span><span class="s1">'APPLE'</span><span class="p">]</span><span class="w">

</span><span class="nf">names</span><span class="p">(</span><span class="n">dados</span><span class="p">)[</span><span class="nf">names</span><span class="p">(</span><span class="n">dados</span><span class="p">)</span><span class="o">==</span><span class="s2">"SP500index"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"sp500"</span><span class="w">
</span><span class="n">dados</span><span class="o">$</span><span class="n">sp500</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">dados</span><span class="o">$</span><span class="n">sp500</span><span class="p">))</span><span class="w">

</span><span class="n">dados</span><span class="o">$</span><span class="n">sp500</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="n">diff</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">dados</span><span class="o">$</span><span class="n">sp500</span><span class="p">)))</span><span class="w">
</span><span class="n">dados</span><span class="o">$</span><span class="n">APPLE</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="n">diff</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">dados</span><span class="o">$</span><span class="n">APPLE</span><span class="p">)))</span><span class="w">

</span><span class="n">spxret</span><span class="o">&lt;-</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">spxret</span><span class="p">)</span><span class="w">    
</span></code></pre>
</div>

<p>The <code class="highlighter-rouge">spxret</code> and<code class="highlighter-rouge"> applret</code> commands extract a column to create a vector. In the following lines of the code above, we work on the database to turn all data into numerics, removing NA’s (No Data values) and transforming returns into log returns.
   
In our analysis we obtained, in one year, 251 daily returns. Randomly a bootstrap sample was obtained from daily returns. In our case, you will notice that some days will appear several times in the bootstrap sample while others will not appear at all. This is due to the fact that we perform sampling with replacement. From our bootstrap sample, we chose to perform the sum of the values. Typically several bootstrap samples are created.</p>

<p>The code below shows how to use Bootstrap to generate 1000 Bootstrap samples. We can see below that we sample with integers from 1 to 251. We created a sample of size 251 and sample it with replacement. With the command <code class="highlighter-rouge">this.samp</code> we get a year with daily returns that could have happened. We collect annual returns for each hypothetical year in the following code line.</p>

<div class="language-R highlighter-rouge">
<pre class="highlight"><code><span class="n">spx.boot.sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">numeric</span><span class="p">(</span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="c1"># numeric vector 1000 long
</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">this.samp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">spxret</span><span class="p">[</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">251</span><span class="p">,</span><span class="w"> </span><span class="m">251</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="n">spx.boot.sum</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">this.samp</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
<p>You can also plot the annual returns distribution obtained using Bootstrap with the following code:</p>

<div class="language-R highlighter-rouge">
<pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">density</span><span class="p">(</span><span class="n">spx.boot.sum</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"orange"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">spxret</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>
<p>According to the image below, the annual return is quite variable. If you use a different initial database, your chart will change. In this case we find that our annual return is very close to the middle of the distribution. It is noteworthy that this result may be different due to statistical biases or the database.</p>

<p><img src="https://i.imgur.com/HrxEhHM.png" alt=""></p>

<h3 id="lets-practice">Let’s practice?</h3>

<h2 id="references">References</h2>

<p>Efron, B. (1979). Bootstrap methods: another look at the jackknife. The annals of Statistics, 1-26.</p>

<p>Efron, B, and Tibshirani, R.J. (1993). An introduction to the bootstrap. Chapman and Hall, London.</p>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/06/18/itro-ao-deep-learning/" data-toggle="tooltip" data-placement="top" title="Uma Abordagem Intuitiva às Redes Neurais">← Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/06/28/Bootstrap/" data-toggle="tooltip" data-placement="top" title="Bootstrap">Next Post →</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>
<div id="disqusbox">
    <div id="disqus_thread" width="500px"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = 'https://lamfo.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

</div>
<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/lamfounb">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/lamfo-unb">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:lamfo@unb.br">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright © LAMFO - UNB 2017</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js%20"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js%20"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js%20"></script>


    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-97417743-1', 'auto');
  ga('send', 'pageview');

</script>



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML,Safe"></script>

</body>

</html>
